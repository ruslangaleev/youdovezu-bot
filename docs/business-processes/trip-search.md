# Поиск объявлений от Requester'ов

## Общее описание

Поиск объявлений — это процесс, позволяющий Offerer'ам находить опубликованные запросы на поездки от Requester'ов и предлагать им свои услуги. Процесс начинается с выбора населенного пункта, затем отображается список объявлений, и Offerer может предложить цену Requester'у.

## Участники процесса

- **Offerer** — пользователь, который предоставляет автомобиль и ищет объявления для предложения своих услуг
- **Requester** — пользователь, который опубликовал запрос на поездку и ожидает предложений от Offerer'ов

## Предварительные условия

Для участия в процессе поиска объявлений Offerer должен:
1. Загрузить все необходимые документы (водительское удостоверение, СТС, аватарка)
2. Пройти модерацию документов администратором
3. Получить статус "Одобрено" (Approved) для своих документов
4. Иметь доступ к функции просмотра запросов от Requester'ов

## Процесс поиска объявлений

### Шаг 1: Offerer открывает страницу поиска

1. Offerer в Telegram боте нажимает на кнопку "Поездки"
2. Открывается веб-приложение внутри Telegram
3. В главном меню отображается кнопка "Предложить машину"
4. Offerer нажимает кнопку "Предложить машину"
5. Если документы не проверены или отклонены → отображается страница статуса документов
6. Если документы одобрены → открывается страница поиска объявлений

### Шаг 2: Выбор населенного пункта для поиска

**Элементы страницы:**
- Заголовок "Поиск объявлений"
- Список населенных пунктов Республики Башкортостан
- Кнопка "Назад" для возврата в главное меню

**Список населенных пунктов:**
- Населенные пункты отображаются в виде списка
- Для каждого населенного пункта отображается количество опубликованных поездок от Requester'ов
- Каждый населенный пункт кликабелен
- При нажатии на населенный пункт открывается список объявлений для этого населенного пункта

**Состояния:**
- Если населенных пунктов нет → показывается сообщение "Нет доступных населенных пунктов"
- Если есть населенные пункты → отображается список с возможностью выбора

### Шаг 3: Просмотр объявлений в выбранном населенном пункте

После выбора населенного пункта открывается страница со списком объявлений.

**Элементы страницы:**
- Заголовок с названием выбранного населенного пункта
- Кнопка "Назад" для возврата к выбору населенного пункта
- Список объявлений от Requester'ов в выбранном населенном пункте

**Информация об объявлении:**
- Откуда (населенный пункт и адрес)
- Куда (населенный пункт и адрес)
- Дата создания объявления
- Комментарий Requester'а (если есть)
- Статус объявления (Активно / Закрыто)
- Кнопка "Предложить цену"

**Состояния:**
- Если объявлений нет → показывается сообщение "В этом населенном пункте пока нет объявлений"
- Если есть объявления → отображается список с возможностью выбора
- Отображаются только активные объявления (статус "Активно")

**Фильтрация:**
- По умолчанию показываются все активные объявления в выбранном населенном пункте
- Возможность фильтрации по населенным пунктам отправления и назначения (опционально)

### Шаг 4: Просмотр детальной информации об объявлении

После выбора объявления из списка открывается страница с детальной информацией.

**Элементы страницы:**
- Заголовок "Объявление"
- Кнопка "Назад" для возврата к списку объявлений
- Детальная информация об объявлении:
  - Полный адрес отправления (населенный пункт, улица, дом)
  - Полный адрес назначения (населенный пункт, улица, дом)
  - Дата создания объявления
  - Комментарий Requester'а
  - Информация о Requester'е (имя, фамилия, рейтинг, если есть)
- Кнопка "Показать на карте" для просмотра маршрута
- Форма для предложения цены:
  - Поле ввода цены (в рублях)
  - Комментарий к предложению (опционально)
  - Кнопка "Отправить предложение"

**Валидация формы:**
- Цена обязательна для заполнения
- Цена должна быть положительным числом
- Комментарий необязателен

### Шаг 5: Отправка предложения цены

1. Offerer заполняет форму предложения:
   - Указывает цену за поездку
   - При необходимости добавляет комментарий
2. Нажимает кнопку "Отправить предложение"
3. Система проверяет валидность данных
4. Если данные валидны:
   - Предложение отправляется Requester'у
   - Requester получает уведомление в Telegram бот о новом предложении
   - Offerer видит сообщение "Предложение успешно отправлено"
   - Отображается кнопка "Вернуться к списку объявлений"
5. Если данные невалидны:
   - Отображается сообщение об ошибке
   - Форма остается открытой для исправления

**Информация в предложении:**
- Цена за поездку
- Комментарий Offerer'а (если указан)
- Информация об Offerer'е (имя, фамилия, данные автомобиля после одобрения документов)
- Дата и время отправки предложения

### Шаг 6: Requester получает предложение

1. Requester получает уведомление в Telegram бот о новом предложении
2. В уведомлении отображается:
   - Информация об Offerer'е
   - Предложенная цена
   - Краткая информация о маршруте
3. Requester может:
   - Открыть веб-приложение для просмотра детальной информации
   - Принять предложение
   - Отклонить предложение
   - Задать вопросы Offerer'у (через чат в Telegram)

## Дополнительные функции

### Обновление списка объявлений

- Кнопка "Обновить" для обновления списка объявлений
- Автоматическое обновление списка при возврате на страницу (опционально)

### Поиск по ключевым словам

- Поле поиска для фильтрации объявлений по населенным пунктам или адресам
- Поиск работает в реальном времени при вводе текста

### Сортировка объявлений

- По дате создания (новые сначала / старые сначала)
- По населенному пункту отправления
- По населенному пункту назначения

### История предложений

- Offerer может просмотреть историю своих предложений
- Для каждого предложения отображается:
  - Объявление, на которое было отправлено предложение
  - Предложенная цена
  - Статус предложения (Ожидает ответа / Принято / Отклонено)
  - Дата отправки

## Ограничения и правила

1. **Доступ к поиску:**
   - Только Offerer'ы с одобренными документами могут просматривать объявления
   - Requester'ы не могут просматривать объявления других Requester'ов

2. **Предложения:**
   - Offerer может отправить только одно предложение на одно объявление
   - После отправки предложения кнопка "Предложить цену" становится неактивной или меняется на "Предложение отправлено"

3. **Актуальность объявлений:**
   - Отображаются только активные объявления
   - Закрытые объявления не отображаются в списке
   - Объявления автоматически скрываются после истечения срока актуальности (если установлен)

4. **Конфиденциальность:**
   - Полная информация о Requester'е отображается только после отправки предложения
   - До отправки предложения отображается только публичная информация

## Статусы объявлений

- **Активно** — объявление активно, Requester ожидает предложений
- **Закрыто** — объявление закрыто, Requester больше не ищет предложения
- **Выполнено** — поездка состоялась, объявление закрыто автоматически

## Уведомления

### Для Offerer'а:
- Подтверждение успешной отправки предложения
- Уведомление о принятии предложения Requester'ом
- Уведомление об отклонении предложения Requester'ом

### Для Requester'а:
- Уведомление о новом предложении от Offerer'а
- Уведомление о деталях предложения (цена, комментарий, информация об Offerer'е)

## Технические детали

### Населенные пункты Республики Башкортостан

Список населенных пунктов формируется на основе административно-территориального деления Республики Башкортостан. Населенные пункты могут быть сгруппированы по географическим признакам или отображаться в алфавитном порядке.

### Фильтрация объявлений

Объявления фильтруются по следующим критериям:
- Населенный пункт (обязательный фильтр)
- Статус объявления (только активные)
- Населенный пункт отправления (опционально)
- Населенный пункт назначения (опционально)

### Геолокация

При выборе объявления Offerer может:
- Просмотреть маршрут на карте
- Открыть Яндекс.Карты для детального просмотра маршрута
- Оценить расстояние и время в пути

