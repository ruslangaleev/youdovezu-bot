# Правила для ИИ (AI Assistant)

## Основные принципы работы

### 1. Git и версионный контроль
- **НИКОГДА не фиксировать изменения в git самостоятельно**
- Все изменения в git (git add, git commit, git push) выполняются ТОЛЬКО по явному указанию пользователя
- При завершении задач НЕ предлагать автоматически зафиксировать изменения
- Ждать команды пользователя перед любыми git операциями

### 2. Контекст и понимание проекта
- Cursor не понимает полный контекст проекта и может допустить лишнее написание кода
- Перед внесением изменений всегда анализировать существующую структуру проекта
- Избегать дублирования функциональности
- Следовать принципам Clean Architecture, уже заложенным в проекте

### 3. Структура проекта
- Соблюдать разделение на слои: Domain, Application, Infrastructure, Presentation
- Новые сервисы размещать в соответствующем слое
- Интерфейсы в Application, реализации в Infrastructure или Application
- Контроллеры только в Presentation слое

### 4. Код и качество
- Писать чистый, читаемый код
- **ВСЕГДА добавлять комментарии к коду** - XML комментарии для классов, методов, свойств
- Добавлять необходимые using директивы
- Использовать dependency injection
- Логировать важные операции
- Обрабатывать исключения
- Комментировать сложную бизнес-логику
- Добавлять комментарии к конфигурационным настройкам

### 5. Конфигурация
- Все настройки выносить в appsettings.json
- Использовать строго типизированные модели конфигурации
- Не хардкодить значения в коде

### 6. Документация
- Обновлять README при значительных изменениях
- Комментировать сложную логику
- Документировать API endpoints

### 7. Безопасность
- Не хранить секретные данные в коде
- Использовать User Secrets для разработки
- Валидировать входящие данные

### 8. Сборка и тестирование
- **После ЛЮБЫХ изменений в коде обязательно выполнять сборку проекта**
- Команда: `dotnet build` в папке backend
- Если есть ошибки компиляции - исправлять их самостоятельно
- Если ошибки критичны для бизнес-логики - согласовывать решения с пользователем
- Проверять линтер ошибки после изменений

### 9. Docker и контейнеры
- **НЕ запускать Docker контейнеры самостоятельно**
- Выполнять `docker-compose up` или `docker build` ТОЛЬКО по явному запросу пользователя
- Можно использовать Docker для сборки, но не для запуска сервисов

### 10. Самостоятельное определение правил
- **Анализировать требования пользователя** и выявлять паттерны поведения
- **Самостоятельно определять**, что стоит вынести в правила на основе:
  - Повторяющихся запросов пользователя
  - Частых ошибок или проблем
  - Предпочтений в стиле кода
  - Требований к качеству и процессам
- **Обновлять файл AI_RULES.md** при выявлении новых правил
- **Фиксировать правила** сразу после их определения
- **Применять новые правила** ко всем последующим задачам

### 11. Откат изменений
- **НИКОГДА не трогать последний коммит** при откате изменений
- Если пользователь просит "откатить последние изменения" - это означает откатить **незафиксированные изменения** в рабочей директории
- **НЕ использовать** `git reset --hard HEAD~1` или подобные команды для удаления коммитов
- **Использовать** `git checkout .` или `git restore .` для отката незафиксированных изменений
- **Коммиты в истории** должны оставаться нетронутыми
- **Спрашивать уточнения** если неясно, что именно нужно откатить

### 12. Ответы на вопросы
- **Если пользователь задает вопрос** - отвечать ТОЛЬКО на вопрос без внесения изменений в проект
- **НЕ выполнять** никаких действий с кодом, файлами или git до явного запроса
- **НЕ предлагать** автоматически исправления или улучшения
- **Ждать команды** пользователя перед любыми изменениями в проекте
- **Отвечать кратко и по существу** на поставленный вопрос

### 13. Переменные окружения и Configuration API
- **Использовать стандартный синтаксис Configuration API** для переменных окружения
- **Формат переменных:** `SectionName__PropertyName` (двойное подчеркивание)
- **Примеры:** `Telegram__BotToken`, `Database__ConnectionString`, `Logging__LogLevel`
- **Автоматический маппинг:** `Telegram__BotToken` → `Telegram:BotToken` в конфигурации
- **Обязательно добавлять** `builder.Configuration.AddEnvironmentVariables()` в Program.cs
- **Использовать IOptions Pattern** для типизированных настроек
- **Валидировать обязательные значения** при старте приложения с понятными сообщениями об ошибках
- **Логирование переменных окружения** только в Development режиме

---
